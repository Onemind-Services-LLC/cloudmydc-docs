"use strict";(self.webpackChunkcloudmydc_docs=self.webpackChunkcloudmydc_docs||[]).push([[4060],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var i=a.createContext({}),c=function(e){var t=a.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=c(e.components);return a.createElement(i.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(r),g=n,m=d["".concat(i,".").concat(g)]||d[g]||u[g]||o;return r?a.createElement(m,s(s({ref:t},p),{},{components:r})):a.createElement(m,s({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,s=new Array(o);s[0]=g;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[d]="string"==typeof e?e:n,s[1]=l;for(var c=2;c<o;c++)s[c]=r[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,r)}g.displayName="MDXCreateElement"},7890:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=r(87462),n=(r(67294),r(3905));const o={sidebar_position:5},s=void 0,l={unversionedId:"Data Storage Container/Migrating to GlusterFS Cluster",id:"Data Storage Container/Migrating to GlusterFS Cluster",title:"Migrating to GlusterFS Cluster",description:"Migrating Standalone Storage to GlusterFS Cluster",source:"@site/docs/Data Storage Container/Migrating to GlusterFS Cluster.md",sourceDirName:"Data Storage Container",slug:"/Data Storage Container/Migrating to GlusterFS Cluster",permalink:"/docs/Data Storage Container/Migrating to GlusterFS Cluster",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Data Storage Container/Migrating to GlusterFS Cluster.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"External Server",permalink:"/docs/Data Storage Container/Use Cases/External Server"},next:{title:"External NFS Server Configuration",permalink:"/docs/Data Storage Container/External NFS Server Configuration"}},i={},c=[{value:"Migrating Standalone Storage to GlusterFS Cluster",id:"migrating-standalone-storage-to-glusterfs-cluster",level:2}],p={toc:c},d="wrapper";function u(e){let{components:t,...o}=e;return(0,n.kt)(d,(0,a.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"migrating-standalone-storage-to-glusterfs-cluster"},"Migrating Standalone Storage to GlusterFS Cluster"),(0,n.kt)("p",null,"Currently, automatic conversion of the existing standalone storage into the GlusterFS cluster is not supported. You\u2019ll need to recreate the storage from scratch. We recommend creating a temporary Storage node in the extra layer, copy data, and remount any existing shares. Then, recreate the initial Storage node as a GlusterFS cluster and restore data and mount shares back. The instruction below will guide you through the process step-by-step."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Locate the required environment in your platform dashboard and click the ",(0,n.kt)("strong",{parentName:"li"},"Change Environment Topology")," button.")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(50505).Z,width:"790",height:"202"}))),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"Within the opened wizard, add a new ",(0,n.kt)("strong",{parentName:"li"},"Shared Storage")," node in the Extra layer. Click ",(0,n.kt)("strong",{parentName:"li"},"Apply")," to proceed.")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(64846).Z,width:"978",height:"607"}))),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"Connect to your initial (source) Storage node via ",(0,n.kt)("a",{parentName:"li",href:"https://cloudmydc.com/"},"SSH"),", e.g. using the built-in ",(0,n.kt)("strong",{parentName:"li"},"Web SSH")," client. Run the following command to ",(0,n.kt)("a",{parentName:"li",href:"https://cloudmydc.com/"},"generate")," a keypair that will be used to interconnect two storages:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"ssh-keygen -f ~/.ssh/storage\n")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(61859).Z,width:"920",height:"552"}))),(0,n.kt)("p",null,"You can view the generated public key with the command below:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"cat  ~/.ssh/storage.pub\n")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(85597).Z,width:"920",height:"289"}))),(0,n.kt)("p",null,"Use the ",(0,n.kt)("strong",{parentName:"p"},"Ctrl+Shift+\u0421")," or ",(0,n.kt)("strong",{parentName:"p"},"\u0421md+C")," shortcut in the Web SSH panel to copy the key."),(0,n.kt)("ol",{start:4},(0,n.kt)("li",{parentName:"ol"},"Switch to your new Shared Storage node and connect to it via ",(0,n.kt)("a",{parentName:"li",href:"https://cloudmydc.com/"},"SSH")," as well. Insert public key from the previous step to the ",(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("em",{parentName:"strong"},"~/.ssh/authorized_keys"))," file using any preferred editor, for example:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"vim ~/.ssh/authorized_keys\n")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(2480).Z,width:"920",height:"334"}))),(0,n.kt)("ol",{start:5},(0,n.kt)("li",{parentName:"ol"},"Return to the source storage and copy required data to a new node via the ",(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("em",{parentName:"strong"},"rsync"))," utility:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'cd /data; rsync -az . {NEW_STORAGE_IP}:/data/ -e "ssh -i $HOME/.ssh/storage"\n')),(0,n.kt)("p",null,"Here, the ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"{NEW_STORAGE_IP}"))," placeholder should be substituted with the internal IP address of your new storage that can be viewed in the dashboard."),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(13923).Z,width:"920",height:"359"}))),(0,n.kt)("p",null,"Confirm connection by typing ",(0,n.kt)("em",{parentName:"p"},"\u201cyes\u201d")," when prompted. The operation may require some time that depends on the amount of copied data."),(0,n.kt)("ol",{start:6},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("a",{parentName:"li",href:"https://cloudmydc.com/"},"Remount")," application data from the initial to temporary storage.")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"click the ",(0,n.kt)("strong",{parentName:"li"},"Config")," button next to our application server and ",(0,n.kt)("strong",{parentName:"li"},"Unmount")," the current Shared Storage.")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(28046).Z,width:"920",height:"325"}))),(0,n.kt)("p",null,"next, create a new ",(0,n.kt)("strong",{parentName:"p"},"Mount")," to your temporary storage server"),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(95806).Z,width:"714",height:"393"}))),(0,n.kt)("ol",{start:7},(0,n.kt)("li",{parentName:"ol"},"Standalone Shared Storage can be replaced with a GlusterFS storage cluster in two steps:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"open the ",(0,n.kt)("strong",{parentName:"li"},"Change Environment Topology")," wizard, remove the appropriate storage node altogether, and ",(0,n.kt)("strong",{parentName:"li"},"Apply")," changes")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(32718).Z,width:"978",height:"607"}))),(0,n.kt)("p",null,"access topology wizard once more and add Shared Storage node with the ",(0,n.kt)("strong",{parentName:"p"},"Auto-Clustering")," option enabled"),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(42690).Z,width:"978",height:"607"}))),(0,n.kt)("ol",{start:8},(0,n.kt)("li",{parentName:"ol"},"Return data from the temporary storage server in the Extra layer to a new Shared Storage cluster with GlusterFS support.")),(0,n.kt)("u",null,"Repeat the 3-7 steps"),", using the temporary storage as source and master node of the GlusterFS cluster as target.",(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(5464).Z,width:"714",height:"392"}))),(0,n.kt)("ol",{start:9},(0,n.kt)("li",{parentName:"ol"},"Remove the temporary storage from the ",(0,n.kt)("em",{parentName:"li"},"Extra")," layer.")),(0,n.kt)("div",{style:{display:"flex",justifyContent:"center",margin:"0 0 1rem 0"}},(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Locale Dropdown",src:r(64901).Z,width:"978",height:"607"}))),(0,n.kt)("p",null,"That\u2019s all! Now, you have a GlusterFS cluster instead of the standalone storage node."))}u.isMDXComponent=!0},50505:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/01-change-environment-topology-button-baabfec69847eb2fdab5b300acc95b68.png"},64846:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/02-add-temporary-storage-node-4ed7c9dcb2503beaae4b6c3420e9b9a1.png"},61859:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/03-generate-ssh-keypair-bd69de57311795ba2c4c8a7ec127636e.png"},85597:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/04-copy-public-key-e56791c120f5fb301f957f585b76ca6b.png"},2480:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/05-add-key-to-authorizedkeys-file-cd680909b08aee7f92cc376bc4904fd4.png"},13923:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/06-copy-data-between-storages-via-rsync-e25f95e646b6b8dc15d4b06ec950376b.png"},28046:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/07-unmount-initial-storage-8884a315c7701efcf8e9fdc1f607106f.png"},95806:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/08-mount-temporary-storage-fac51a534b3e9ab8b13ec715beec872c.png"},32718:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/09-remove-initial-storage-node-ab84b135099c8a9213fbf50dbb95e000.png"},42690:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/10-add-glusterfs-cluster-b2148db859fb7fc1bd95bf01745dee0b.png"},5464:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/11-mount-glusterfs-cluster-16892c8b5604d7dd5b3260b82ae23be7.png"},64901:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/12-remove-temporary-storage-node-53eae19b54d76ec962c7003100c413fa.png"}}]);